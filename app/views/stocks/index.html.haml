%p#notice= notice
%h1 Stocks
%table
  %thead
    %tr
      %th
      %th Name
      %th Currency symbol
      %th Current Price
      %th Market Cap
      %th 24h High
      %th 24h Low
      %th All-time High
      %th{:colspan => "3"}
  %tbody
    - @stocks.each do |stock|
      %tr
        %td= image_tag(stock.image, :size =>'30x30')
        %td= stock.name
        %td= stock.symbol
        - data = @market_data.select {|coin| coin["symbol"] == stock.symbol.to_s }
        - if data != []
          %td= number_to_currency(data[0].dig("current_price"), unit: "₱ ", separator: ".", delimiter: ",").to_s
          %td= number_to_currency(data[0].dig("market_cap"), unit: "₱ ", separator: ".", delimiter: ",").to_s
          %td= number_to_currency(data[0].dig("high_24h"), unit: "₱ ", separator: ".", delimiter: ",").to_s
          %td= number_to_currency(data[0].dig("low_24h"), unit: "₱ ", separator: ".", delimiter: ",").to_s
          %td= number_to_currency(data[0].dig("ath"), unit: "₱ ", separator: ".", delimiter: ",").to_s
        - else
          %td
          %td
          %td
          %td
          %td
      -#   %td= stock.current_price
      -#   %td= stock.current_market_cap
      -#   %td= stock.current_price
      -#   %td= stock.current_price
      -#   %td= stock.current_price
      -# - else
      -#   %td
      -#   %td
      -#   %td
      -#   %td
      -#   %td
        %td= link_to 'Show', stock
        %td= link_to 'Edit', edit_stock_path(stock)
        %td= link_to 'Destroy', stock, method: :delete, data: { confirm: 'Are you sure?' }

%br/
= link_to 'New Stock', new_stock_path
